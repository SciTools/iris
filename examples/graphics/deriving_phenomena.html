

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Deriving Exner Pressure and Air Temperature &mdash; Iris 0.89 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.89',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="top" title="Iris 0.89 documentation" href="../../index.html" />
    <link rel="up" title="Visualisation examples" href="index.html" />
    <link rel="next" title="Quickplot of a 2d cube on a map" href="global_map.html" />
    <link rel="prev" title="Loading a cube from a custom file format" href="custom_file_loading.html" />
 
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">

  </head>
  <body>
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<!-- Enable this to insert a logo...
<a href="../../index.html"><img src="../../_static/logo.png" style="float:right; clear:left; margin-right: 40px; " border="0" alt="Logo"/></a>
-->

<p style="margin-left: 15px; height:20px; font-weight:bolder; font-size:300%; letter-spacing:0.1ex;">
Iris 0.89
</p>

</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="global_map.html" title="Quickplot of a 2d cube on a map"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="custom_file_loading.html" title="Loading a cube from a custom file format"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <!-- <li><a href="../../search.html">search</a>|&nbsp;</li> -->
        <li><a href="../index.html">examples</a>|&nbsp;</li>
        <li><a href="../../gallery.html">gallery</a>|&nbsp;</li>
        <li><a href="../../contents.html">contents</a>|&nbsp;</li>

          <li><a href="../index.html" >Iris examples</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Visualisation examples</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="custom_file_loading.html"
                        title="previous chapter">Loading a cube from a custom file format</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="global_map.html"
                        title="next chapter">Quickplot of a 2d cube on a map</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/examples/graphics/deriving_phenomena.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="deriving-exner-pressure-and-air-temperature">
<span id="graphics-deriving-phenomena"></span><h1>Deriving Exner Pressure and Air Temperature<a class="headerlink" href="#deriving-exner-pressure-and-air-temperature" title="Permalink to this headline">Â¶</a></h1>
<p>This example shows some processing of cubes in order to derive further related cubes; in this case
the derived cubes are Exner pressure and air temperature which are calculated by combining air pressure,
air potential temperature and specific humidity. Finally, the two new cubes are presented side-by-side in
a plot.</p>
<p id="deriving-phenomena">[<a class="reference external" href="../../plot_directive/../example_code/graphics/deriving_phenomena.py">source code</a>]</p>
<blockquote>
<div><div class="figure">
<img alt="../../_images/deriving_phenomena.png" src="../../_images/deriving_phenomena.png" />
</div>
</div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Deriving Exner Pressure and Air Temperature</span>
<span class="sd">===========================================</span>

<span class="sd">This example shows some processing of cubes in order to derive further related cubes; in this case</span>
<span class="sd">the derived cubes are Exner pressure and air temperature which are calculated by combining air pressure,</span>
<span class="sd">air potential temperature and specific humidity. Finally, the two new cubes are presented side-by-side in</span>
<span class="sd">a plot.</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span>

<span class="kn">import</span> <span class="nn">iris</span>
<span class="kn">import</span> <span class="nn">iris.coords</span> <span class="kn">as</span> <span class="nn">coords</span>
<span class="kn">import</span> <span class="nn">iris.quickplot</span> <span class="kn">as</span> <span class="nn">qplt</span>


<span class="k">def</span> <span class="nf">limit_colorbar_ticks</span><span class="p">(</span><span class="n">contour_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes a contour object which has an associated colorbar and limits the number of ticks on the colorbar to 4.&quot;&quot;&quot;</span>
    <span class="n">colorbar</span> <span class="o">=</span> <span class="n">contour_object</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">colorbar</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">colorbar</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">sample_data_path</span><span class="p">(</span><span class="s">&#39;PP&#39;</span><span class="p">,</span> <span class="s">&#39;COLPEX&#39;</span><span class="p">,</span> <span class="s">&#39;air_potential_and_air_pressure.pp&#39;</span><span class="p">)</span>

    <span class="c"># the list of phenomena of interest</span>
    <span class="n">phenomena</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;air_potential_temperature&#39;</span><span class="p">,</span> <span class="s">&#39;air_pressure&#39;</span><span class="p">]</span>

    <span class="c"># define the constraint on standard name and model level</span>
    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">phenom</span><span class="p">,</span> <span class="n">model_level_number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">phenom</span> <span class="ow">in</span> <span class="n">phenomena</span><span class="p">]</span>

    <span class="n">air_potential_temperature</span><span class="p">,</span> <span class="n">air_pressure</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">load_strict</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>

    <span class="c"># define a coordinate which represents 1000 hPa</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">AuxCoord</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s">&#39;P0&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&#39;Pa&#39;</span><span class="p">)</span>

    <span class="c"># calculate Exner pressure</span>
    <span class="n">exner_pressure</span> <span class="o">=</span> <span class="p">(</span><span class="n">air_pressure</span> <span class="o">/</span> <span class="n">p0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">287.05</span> <span class="o">/</span> <span class="mf">1005.0</span><span class="p">)</span>
    <span class="c"># set the standard name (the unit is scalar)</span>
    <span class="n">exner_pressure</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s">&#39;exner_pressure&#39;</span><span class="p">)</span>


    <span class="c"># calculate air_temp</span>
    <span class="n">air_temperature</span> <span class="o">=</span> <span class="n">exner_pressure</span> <span class="o">*</span> <span class="n">air_potential_temperature</span>
    <span class="c"># set phenomenon definition and unit</span>
    <span class="n">air_temperature</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s">&#39;air_temperature&#39;</span>
    <span class="n">air_temperature</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s">&#39;K&#39;</span>


    <span class="c"># Now create an iterator which will give us lat lon slices of exner pressure and air temperature in</span>
    <span class="c"># the form [exner_slice, air_temp_slice]</span>
    <span class="n">lat_lon_slice_pairs</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">izip</span><span class="p">(</span>
                                         <span class="n">exner_pressure</span><span class="o">.</span><span class="n">slices</span><span class="p">([</span><span class="s">&#39;grid_latitude&#39;</span><span class="p">,</span> <span class="s">&#39;grid_longitude&#39;</span><span class="p">]),</span>
                                         <span class="n">air_temperature</span><span class="o">.</span><span class="n">slices</span><span class="p">([</span><span class="s">&#39;grid_latitude&#39;</span><span class="p">,</span> <span class="s">&#39;grid_longitude&#39;</span><span class="p">])</span>
                                         <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">exner_slice</span><span class="p">,</span> <span class="n">air_temp_slice</span> <span class="ow">in</span> <span class="n">lat_lon_slice_pairs</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">qplt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">exner_slice</span><span class="p">)</span>

        <span class="c"># The default colorbar has a few too many ticks on it, causing text to overlap. Therefore, limit the number of ticks</span>
        <span class="n">limit_colorbar_ticks</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">qplt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">air_temp_slice</span><span class="p">)</span>
        <span class="n">limit_colorbar_ticks</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c"># For the purposes of this example, break after the first loop - we only want to demonstrate the first plot</span>
        <span class="k">break</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="global_map.html" title="Quickplot of a 2d cube on a map"
             >next</a> |</li>
        <li class="right" >
          <a href="custom_file_loading.html" title="Loading a cube from a custom file format"
             >previous</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <!-- <li><a href="../../search.html">search</a>|&nbsp;</li> -->
        <li><a href="../index.html">examples</a>|&nbsp;</li>
        <li><a href="../../gallery.html">gallery</a>|&nbsp;</li>
        <li><a href="../../contents.html">contents</a>|&nbsp;</li>

          <li><a href="../index.html" >Iris examples</a> &raquo;</li>
          <li><a href="index.html" >Visualisation examples</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
    <p style="text-align: left; float: left; margin: 0px; padding: 0 0 0 5px;">Documentation licensed under the <a href="http://reference.data.gov.uk/id/open-government-licence" rel="license">Open Government Licence</a></p>
        &copy; <a href="../../copyright.html">British Crown Copyright</a> 2010 - 2012, Met Office
    </div>


  </body>
</html>